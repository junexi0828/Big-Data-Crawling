# 통합 파이프라인 실행 가이드

## 🎯 개요

엔터프라이즈급 통합 실행/중지 기능이 추가되었습니다. 이제 하나의 버튼으로 전체 프로세스를 자동으로 실행하거나 중지할 수 있습니다.

## 🚀 통합 실행 기능

### GUI에서 통합 실행

1. **GUI 실행:**

   ```bash
   cd PICU
   source venv/bin/activate
   bash scripts/run_gui.sh
   ```

2. **제어 탭에서:**
   - **▶️ 전체 시작** 버튼 클릭
   - 모든 프로세스가 의존성 순서대로 자동 실행됩니다

### 실행 순서

프로세스는 다음 순서로 자동 실행됩니다:

1. **Backend** (FastAPI 서버)
2. **Kafka Consumer** (Kafka 브로커 필요)
3. **Spider** (Scrapy)
4. **HDFS** (선택적)
5. **Frontend** (React 개발 서버)

### 프로세스 의존성

- **Kafka Consumer** → Kafka 브로커 필요
- **Frontend** → Backend 필요 (선택적)

의존성이 없는 경우 자동으로 의존 프로세스를 먼저 시작합니다.

## 🛑 통합 중지 기능

### GUI에서 통합 중지

1. **⏹️ 전체 중지** 버튼 클릭
2. 확인 메시지에서 "Yes" 선택
3. 모든 프로세스가 역순으로 자동 중지됩니다

### 중지 순서

프로세스는 다음 역순으로 중지됩니다:

1. **Frontend**
2. **Spider**
3. **Kafka Consumer**
4. **HDFS**
5. **Backend**

## 🔄 재시작 기능

**🔄 전체 재시작** 버튼을 클릭하면:

1. 모든 프로세스 중지
2. 2초 대기
3. 모든 프로세스 다시 시작

## 📊 프로세스 상태 모니터링

### 프로세스 상태 테이블

제어 탭의 "통합 파이프라인 제어" 섹션에서:

- 각 프로세스의 현재 상태 확인
- 개별 프로세스 시작/중지 버튼
- 시작 시간 표시

### 상태 종류

- **stopped**: 중지됨
- **starting**: 시작 중
- **running**: 실행 중
- **stopping**: 중지 중
- **error**: 오류 발생

## 🎮 개별 프로세스 제어

통합 실행과 함께 개별 프로세스 제어도 가능합니다:

### Spider 개별 제어

- Spider 선택 드롭다운
- "Spider 시작" / "Spider 중지" 버튼
- 실시간 로그 표시

### 프로세스 상태 테이블에서

각 프로세스 행의 "시작" / "중지" 버튼으로 개별 제어 가능

## 🔧 문제 해결

### Import 오류 해결

**문제:** `ModuleNotFoundError: No module named 'shared'`

**해결:**

- 모든 import 경로가 수정되었습니다
- `cointicker/shared` 경로를 정확히 참조하도록 업데이트

### 프로세스가 시작되지 않을 때

1. 의존성 확인:

   - Kafka Consumer는 Kafka 브로커가 실행 중이어야 함
   - Frontend는 Backend가 실행 중이어야 함 (선택적)

2. 로그 확인:

   - 제어 탭의 실시간 로그 확인
   - 에러 메시지 확인

3. 수동 실행 테스트:

   ```bash
   # Backend
   bash cointicker/backend/run_server.sh

   # Frontend
   bash cointicker/frontend/run_dev.sh

   # Kafka Consumer
   python cointicker/worker-nodes/kafka_consumer.py
   ```

### 프로세스 상태가 업데이트되지 않을 때

- 통계 타이머가 2초마다 자동 업데이트
- 수동 새로고침: F5 키 또는 "새로고침" 메뉴

## 📋 사용 시나리오

### 시나리오 1: 처음 시작

1. GUI 실행
2. "▶️ 전체 시작" 클릭
3. 모든 프로세스 자동 실행
4. 프로세스 상태 테이블에서 확인

### 시나리오 2: 특정 프로세스만 실행

1. 프로세스 상태 테이블에서 원하는 프로세스의 "시작" 버튼 클릭
2. 의존성이 있으면 자동으로 의존 프로세스도 시작

### 시나리오 3: 전체 재시작

1. "🔄 전체 재시작" 클릭
2. 모든 프로세스가 순서대로 중지 후 재시작

## 🎯 주요 개선 사항

### 이전 방식

- 각 프로세스를 개별적으로 실행해야 함
- 수동으로 의존성 확인 필요
- 프로세스 간 순서 관리 어려움

### 현재 방식

- ✅ 하나의 버튼으로 전체 실행/중지
- ✅ 자동 의존성 관리
- ✅ 프로세스 상태 실시간 모니터링
- ✅ 개별 제어도 가능

## 📝 기술 세부사항

### PipelineOrchestrator 클래스

- 프로세스 의존성 정의
- 순서대로 자동 실행
- 상태 관리
- 에러 처리

### 프로세스 모니터링

- ProcessMonitor를 통한 실시간 로그 수집
- 통계 자동 추출
- GUI 실시간 업데이트
