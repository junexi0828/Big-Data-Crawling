# 핫스팟 기반 클러스터 구성 가능성 분석

**작성일**: 2025-12-07
**시나리오**: 핫스팟 열기 → 라즈베리파이 4대 + 맥 + 휴대폰 → SSH 연결 → 3중 클러스터 작동

---

## ✅ 기술적 가능성: **가능하지만 제약사항 있음**

### 1. 네트워크 구성

#### 핫스팟 네트워크 특성

- **IP 대역**: 일반적으로 `192.168.43.x` (Android) 또는 `172.20.10.x` (iOS)
- **최대 연결 디바이스**: 8-10개 (제조사/모델에 따라 다름)
- **대역폭**: 일반적으로 2.4GHz WiFi, 최대 150Mbps (이론상)
- **안정성**: 이동 중일 때는 불안정할 수 있음

#### 구성 예시

```
핫스팟 (휴대폰)
├── 라즈베리파이 Master (192.168.43.100)
├── 라즈베리파이 Worker1 (192.168.43.101)
├── 라즈베리파이 Worker2 (192.168.43.102)
├── 라즈베리파이 Worker3 (192.168.43.103)
├── 맥 (192.168.43.104) - GUI 실행
└── 휴대폰 자체 (192.168.43.1) - 핫스팟 호스트
```

---

## ⚠️ 주요 제약사항

### 1. 네트워크 안정성

- **핫스팟은 이동 중 불안정**: HDFS/Kafka 클러스터는 안정적인 네트워크 필요
- **대역폭 제한**: 6개 디바이스가 동시 통신 시 병목 발생 가능
- **지연 시간**: 무선 네트워크 특성상 지연 시간 증가

### 2. IP 주소 동적 할당

- **핫스팟은 일반적으로 DHCP 사용**: IP 주소가 변경될 수 있음
- **해결책**: 라즈베리파이에서 고정 IP 설정 필요 (netplan 사용)

### 3. 네트워크 설정 변경 필요

- **현재 설정**: `192.168.0.x` 대역 사용
- **핫스팟 대역**: `192.168.43.x` 또는 `172.20.10.x`
- **필요 작업**: `cluster_config.yaml` 및 netplan 설정 수정

---

## 🔧 구현 방법

### 1. 핫스팟 네트워크 설정

#### Step 1: 핫스팟 IP 대역 확인

```bash
# 휴대폰에서 핫스팟 활성화 후
# 맥에서 연결하여 IP 확인
ifconfig | grep "inet "
# 예시 출력: inet 192.168.43.104
# → 핫스팟 대역: 192.168.43.x
```

#### Step 2: cluster_config.yaml 수정

```yaml
cluster:
  name: "cointicker-cluster"
  master:
    hostname: "raspberry-master"
    ip: "192.168.43.100" # 핫스팟 대역으로 변경
    user: "ubuntu"
    ssh_port: 22
  workers:
    - hostname: "raspberry-worker1"
      ip: "192.168.43.101" # 핫스팟 대역으로 변경
      user: "ubuntu"
      ssh_port: 22
    # ... 나머지 워커 노드도 동일하게 변경
```

#### Step 3: 라즈베리파이 고정 IP 설정

각 라즈베리파이에서 netplan 설정:

```yaml
# /etc/netplan/99-static-ip.yaml
network:
  version: 2
  wifis:
    wlan0:
      dhcp4: no
      addresses:
        - 192.168.43.100/24 # Master
        # - 192.168.43.101/24  # Worker1
        # - 192.168.43.102/24  # Worker2
        # - 192.168.43.103/24  # Worker3
      routes:
        - to: default
          via: 192.168.43.1 # 핫스팟 게이트웨이
      nameservers:
        addresses:
          - 8.8.8.8
          - 8.8.4.4
      access-points:
        "핫스팟_SSID": # 휴대폰 핫스팟 이름
          password: "핫스팟_비밀번호"
```

```bash
# 적용
sudo netplan apply
```

### 2. SSH 연결 설정

#### Step 1: SSH 키 복사

```bash
# 맥에서 각 라즈베리파이로 SSH 키 복사
ssh-copy-id ubuntu@192.168.43.100  # Master
ssh-copy-id ubuntu@192.168.43.101  # Worker1
ssh-copy-id ubuntu@192.168.43.102  # Worker2
ssh-copy-id ubuntu@192.168.43.103  # Worker3
```

#### Step 2: SSH 연결 테스트

```bash
# 맥에서 테스트
ssh ubuntu@192.168.43.100 "hostname"  # raspberry-master
ssh ubuntu@192.168.43.101 "hostname"  # raspberry-worker1
```

### 3. GUI에서 클러스터 모니터링

현재 시스템은 이미 클러스터 모니터링을 지원합니다:

```python
# GUI가 자동으로 cluster_config.yaml을 읽어서
# ClusterMonitor를 통해 각 노드 상태 확인
from gui.monitors.cluster_monitor import ClusterMonitor

monitor = ClusterMonitor()
status = monitor.get_node_status("192.168.43.100")
```

---

## 📊 성능 및 안정성 예상

### 장점 ✅

1. **이동성**: 어디서든 클러스터 구성 가능
2. **빠른 설정**: 공유기 설정 불필요
3. **독립 네트워크**: 다른 네트워크와 격리

### 단점 ⚠️

1. **네트워크 안정성**: 핫스팟은 이동 중 불안정
2. **대역폭 제한**: 6개 디바이스 동시 통신 시 병목
3. **배터리 소모**: 휴대폰 배터리 빠른 소모
4. **연결 제한**: 핫스팟 최대 연결 수 제한 (8-10개)

### 권장 사용 시나리오

- ✅ **정적 환경**: 카페, 도서관 등 고정된 장소
- ✅ **테스트/데모**: 클러스터 기능 테스트
- ✅ **임시 구성**: 공유기 없이 빠르게 구성
- ❌ **프로덕션**: 장기 운영에는 공유기 네트워크 권장

---

## 🔍 실제 작동 가능성 검증

### 1. 네트워크 연결 테스트

```bash
# 맥에서 각 노드 ping 테스트
ping -c 5 192.168.43.100  # Master
ping -c 5 192.168.43.101  # Worker1
ping -c 5 192.168.43.102  # Worker2
ping -c 5 192.168.43.103  # Worker3
```

### 2. SSH 연결 테스트

```bash
# 맥에서 SSH 연결 테스트
for ip in 100 101 102 103; do
  ssh ubuntu@192.168.43.$ip "echo 'OK: $ip'"
done
```

### 3. HDFS 클러스터 연결 테스트

```bash
# 맥에서 HDFS 연결 테스트
hdfs dfs -ls hdfs://192.168.43.100:9000/
```

### 4. Kafka 클러스터 연결 테스트

```bash
# 맥에서 Kafka 브로커 연결 테스트
# (Kafka는 Master 노드에서 실행)
nc -zv 192.168.43.100 9092
```

---

## 🎯 최종 결론

### 현실성 평가: **🟡 조건부 가능**

**가능한 조건:**

1. ✅ 핫스팟 네트워크 안정성 확보 (정적 환경)
2. ✅ 라즈베리파이 고정 IP 설정 완료
3. ✅ SSH 키 인증 설정 완료
4. ✅ 네트워크 대역폭 충분 (6개 디바이스)
5. ✅ 핫스팟 연결 제한 내 (8-10개)

**권장 사항:**

1. **초기 테스트**: 1-2개 노드로 먼저 테스트
2. **네트워크 모니터링**: `ping` 및 `traceroute`로 안정성 확인
3. **대역폭 모니터링**: `iftop` 또는 `nethogs`로 대역폭 사용량 확인
4. **백업 계획**: 핫스팟 실패 시 공유기 네트워크로 전환 가능하도록 준비

**프로덕션 사용:**

- ❌ 장기 운영에는 **공유기 네트워크** 권장
- ✅ 핫스팟은 **테스트/데모/임시 구성**에 적합

---

## 📝 구현 체크리스트

### 사전 준비

- [ ] 핫스팟 IP 대역 확인 (`192.168.43.x` 또는 `172.20.10.x`)
- [ ] 핫스팟 SSID 및 비밀번호 확인
- [ ] 라즈베리파이 4대 WiFi 모듈 확인
- [ ] 맥 WiFi 연결 확인

### 네트워크 설정

- [ ] `cluster_config.yaml` IP 주소 수정
- [ ] 각 라즈베리파이 netplan 설정 (고정 IP)
- [ ] 핫스팟 연결 테스트

### SSH 설정

- [ ] 맥에서 각 라즈베리파이로 SSH 키 복사
- [ ] SSH 연결 테스트
- [ ] 비밀번호 없이 접속 확인

### 클러스터 구성

- [ ] HDFS 클러스터 설정 (Master/Worker)
- [ ] Kafka 브로커 설정 (Master)
- [ ] GUI에서 클러스터 모니터링 확인

### 성능 테스트

- [ ] 네트워크 지연 시간 측정 (`ping`)
- [ ] 대역폭 테스트 (`iperf3`)
- [ ] HDFS 파일 업로드/다운로드 테스트
- [ ] Kafka 메시지 전송/수신 테스트

---

## 🔗 관련 문서

- **클러스터 설정**: [`config/cluster_config.yaml`](../../../cointicker/config/cluster_config.yaml)
- **네트워크 설정**: [`deployment/README.md`](../../../deployment/README.md)
- **SSH 설정**: [`gui/modules/managers/ssh_manager.py`](../../../cointicker/gui/modules/managers/ssh_manager.py)
- **클러스터 모니터링**: [`gui/monitors/cluster_monitor.py`](../../../cointicker/gui/monitors/cluster_monitor.py)

---

**작성자**: Juns AI Assistant
**최종 업데이트**: 2025-12-07
